#!/usr/bin/make -f

# Uncomment this to turn on verbose mode.
export DH_VERBOSE=1

# shared library versions, option 1
#version=2.0.5
#major=2
# option 2, assuming the library is created as src/.libs/libfoo.so.2.0.5 or so
#version=`ls src/.libs/lib*.so.* | \
# awk '{if (match($$0,/[0-9]+\.[0-9]+\.[0-9]+$$/)) print substr($$0,RSTART)}'`
#major=`ls src/.libs/lib*.so.* | \
# awk '{if (match($$0,/\.so\.[0-9]+$$/)) print substr($$0,RSTART+4)}'`

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/makefile.mk
# include /usr/share/cdbs/1/rules/patchsys-quilt.mk
include /usr/share/cdbs/1/rules/utils.mk

DEB_MAKE_INVOKE := $(MAKE) QMAKE_CFLAGS_DEBUG="-g1 -O0"
DEB_MAKE_INSTALL_TARGET := INSTALL_ROOT=$(DEB_DESTDIR) install
DEB_DH_INSTALL_SOURCEDIR := debian/tmp

common-configure-arch:: configure-stamp generate_docs
configure-stamp:
	qmake QMF_INSTALL_ROOT=/usr CONFIG+="$(EXTRA_QMAKE_CONFIG_PARAMS)"  QMAKE_STRIP=/bin/true QMAKE_CXXFLAGS="-g1"
	touch $@

generate_docs:
	cd doc && doxygen
	mkdir -p $(DEB_DH_INSTALL_SOURCEDIR)/usr/doc && cp -R doc/html $(DEB_DH_INSTALL_SOURCEDIR)/usr/doc


